<style>
    body {
        position:fixed;
        top:0px;
        bottom:0px;
        left:0px;
        right:0px;
        font-family: Arial, sans-serif;
        background-color: #ffffff;
    }
    footer {
        position: relative;
    }

    #container{
        height: 99%; 
        margin: auto; 
        display: flex;
        flex-direction: column;
        flex-grow: 1;
        flex-shrink: 1;
        flex-basis: auto;
        min-width: 0;
        min-height: 0;
    }

    #content{
        margin: auto; 
        
        align-items: center;
    }

    #zip{
        align-items: center;
        margin: auto; 
        display: flex; 
        flex-grow: 1;
        flex-shrink: 1;
        flex-basis: 0%;
        justify-content: center;
        
    }
    
    .terminal {
        background-color: transparent;
        color: black;
        font-size: 16px;
        font-family: Ubuntu;
        border: none;
        caret-color: transparent;
    }
    .terminal:focus {
        outline: none;
    }

    #terminal-area {
        width: fit-content;
        margin: 0 auto;
    }

    #terminal-output .line {
        font-family: Ubuntu, Arial, sans-serif;
        font-size: 16px;
        color: black;
        white-space: pre;
        line-height: 1.6;
    }

    .fade-out {
        animation: fadeOut 0.3s ease forwards;
    }

    @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
    }

    .input-wrap {
        position: relative;
        display: inline-flex;
        align-items: center;
    }

    .block-cursor {
        position: absolute;
        pointer-events: none;
        font-family: Ubuntu, Arial, sans-serif;
        font-size: 16px;
        color: black;
        display: none;
        z-index: 1;
        animation: blink-cursor 1s step-end infinite;
    }

    .input-wrap:focus-within .block-cursor {
        display: block;
    }

    @keyframes blink-cursor {
        0%, 100% { opacity: 1; }
        50% { opacity: 0; }
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
    var isAnimating = false;

    function run(event, ele) {
        var key = event.key || '';
        if (key === 'Enter' || event.keyCode === 13) {
            if (isAnimating) return;
            var answer = ele.value.trim();
            if (answer === "") {
                // No-op
            } else if (answer.toUpperCase() === "UNZIP IRON.ZIP") {
                ele.value = "";
                updateCursorPosition();
                runUnzipSequence();
            } else {
                showError(answer);
                ele.value = "";
                updateCursorPosition();
            }
        }
    }

    function showError(command) {
        var output = document.getElementById('terminal-output');
        var cmdLine = document.createElement('div');
        cmdLine.className = 'line';
        cmdLine.textContent = 'user@github:~$ ' + command;
        output.appendChild(cmdLine);

        var errorLine = document.createElement('div');
        errorLine.className = 'line';
        errorLine.textContent = 'zsh: command not found: ' + command + '. Did you mean "unzip iron.zip"?';
        output.appendChild(errorLine);
    }

    function runUnzipSequence() {
        isAnimating = true;
        var input = document.getElementById('input');
        input.disabled = true;
        document.getElementById('cursor').style.display = 'none';

        var output = document.getElementById('terminal-output');
        var cmdLine = document.createElement('div');
        cmdLine.className = 'line';
        cmdLine.textContent = 'user@github:~$ unzip iron.zip';
        output.appendChild(cmdLine);

        var lines = [
            'Archive:  iron.zip',
            '  inflating: index.html'
        ];

        lines.forEach(function(text, index) {
            setTimeout(function() {
                var line = document.createElement('div');
                line.className = 'line';
                line.textContent = text;
                output.appendChild(line);

                if (index === lines.length - 1) {
                    setTimeout(function() {
                        document.body.classList.add('fade-out');
                        setTimeout(function() {
                            window.location.href = 'home.html';
                        }, 300);
                    }, 500);
                }
            }, 200 * (index + 1));
        });
    }

    function updateCursorPosition() {
        var input = document.getElementById('input');
        var cursor = document.getElementById('cursor');
        if (!input || !cursor) return;
        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');
        ctx.font = getComputedStyle(input).font;
        var textWidth = ctx.measureText(input.value).width;
        var paddingLeft = parseFloat(getComputedStyle(input).paddingLeft) || 0;
        cursor.style.left = (paddingLeft + textWidth) + 'px';
    }

    document.addEventListener('DOMContentLoaded', function() {
        var input = document.getElementById('input');
        input.addEventListener('input', updateCursorPosition);
        input.addEventListener('focus', updateCursorPosition);
        updateCursorPosition();
    });

    window.addEventListener('pageshow', function() {
        document.body.classList.remove('fade-out');
        isAnimating = false;
        var input = document.getElementById('input');
        input.disabled = false;
        input.value = "";
        input.focus();
        document.getElementById('cursor').style.display = '';
        document.getElementById('terminal-output').innerHTML = '';
        updateCursorPosition();
    });

</script>

<head>
    <link rel="icon" href="images/iron.png">
    <link rel="apple-touch-icon" href="images/iron.png">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=0.6, maximum-scale=0.6 target-densityDpi=device-dpi">
    <title>Iron</title>
</head>

<body>
    <div id="container">
        <div id="content">
            <div id="zip">
                <a href="#" onclick="runUnzipSequence(); return false;" style="text-decoration: none;">
                    <div>
                        <img src="images/zip.jpg" width="80" alt="iron.zip">
                    </div>
                    <p style="font-size: 13px; font-family: 'Courier New'; text-align: center; margin-top: 3px">iron.zip</p>
                </a>
            </div>

            <div id="terminal-area">
                <div id="terminal-output"></div>
                <div style="display: flex;">
                    <p class="terminal">user@github:~$</p>
                    <span class="input-wrap">
                        <input id="input" class="terminal" onkeydown="run(event, this)" size="42" autofocus/>
                        <span id="cursor" class="block-cursor">&#9608;</span>
                    </span>
                </div>
            </div>
        </div>
    </div>
</body>
