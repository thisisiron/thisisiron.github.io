---
title: "CNN 개요"
categories: MachineLearning
---
어느 방향을 선택하든지 감지하는 것을 학습할 수 있습니다. 이 모든 숫자들이 파라미터를 만들게 되고 데이터로부터 자동으로 학습하며 Edge와 같은 특징들을 배울 수 있습니다.

## Padding
<img src="/assets/images/padding_example.PNG">
위의 예시는 Zero-Padding이라고도 불리우며 끝쪽에 추가하는 것을 Padding이라고 부릅니다.

### 왜 사용할까?
- CNN을 계속 사용하면 이미지가 계속 축소
- 가장자리 픽셀을 한 번 밖에 사용함으로써 이미지의 윤곽 정보를 버림

### 종류
- **Valid**: No Padding
- **Same**: Padding 후 이미지 크기가 기존의 이미지 크기와 같음

### 패딩의 크기
패딩 크기에 관한 수식은 다음과 같습니다. 

$$p = \frac{f-1}{2}$$

패딩의 크기는 대부분 홀수입니다.
1. 짝수라면 패딩이 비대칭이 됩니다.
2. 홀수 크기의 필터 경우 중심 위치가 존재합니다.

## Strided

- 필터의 이동횟수를 의미 -> Strided 값만큼 이동<br>
  Ex. 다음 이미지는 Strided 값이 2인 예시입니다.
<img src="/assets/images/no_padding_strides.gif">

- 최종 크기에 관한 수식은 다음과 같습니다. 소수점이 생기면 대개 내림을 사용하고 필터에 맞춰서 크기가 최대한 정수가 나오도록 만듭니다.
  
$$(\frac{n+2p-f}{s}+1)\times (\frac{n+2p-f}{s}+1)$$

## Multiple Filters

## Pooling Layer
표현의 크기를 줄여 계산이 빨라지고 특징을 더 잘 검출해줄 수 있습니다. 학습하는 변수가 존재하지 않습니다. 즉, Backpropagation 가능한 변수(W)가 존재하지 않습니다.
또한 거의 Pooling의 Strided는 Filter 사이즈와 동일합니다. 겹치지 않도록 Pooling하도록 진행됩니다. 수식은 다음과 같습니다.

$$
\begin{align*}&
f: filter size \newline &
s: stride \newline &
(\frac{n_{h} - f}{s}+1) \times  (\frac{n_w - f}{s}+1)
\end{align*}
$$

### Max Pooling
필터의 부분 중 가장 큰 값을 추출하는 방법입니다. 특징을 더 잘 남기기 때문에 주로 사용되는 방법입니다.
<img src="/assets/images/max_pooling.PNG">

### Average Pooling
필터의 부분의 평균을 내어 값을 도출하는 방법입니다.
<img src="/assets/images/average_pooling.PNG">

## 왜 Convolutions을 사용할까?
### 1. 학습 변수가 작기 때문입니다.
학습 변수가 작은 이유
1. Parameter Sharing -> 같은 filter을 사용하여 계속 연산
2. Sparsity of Connections(희소 연결) -> 32 x 32 이미지 중 5 x 5 만  연결된 Output이 나옵니다. 나머지의 픽셀에 대해 영향을 받지 않게 됩니다. 이럴 경우 Overfitting을 방지할 수 있습니다.

### 2. 이동불변성을 포착가능합니다.
이미지에 약간의 변형이 존재하더라도 이를 알아낼 수 있습니다. 예를 들어 고양이 사진이 몇 픽셀 움직이더라도 고양이 사진으로 인식할 수 있습니다.
--------------------------------

## 1x1 Convolution

## ResNet(Residual Network)


### Reference
Coursera:  Convolutional Neural Networks (Andrew Ng)
[Convolutional Neural Networks (CNNs): An Illustrated Explanation](https://blog.xrds.acm.org/2016/06/convolutional-neural-networks-cnns-illustrated-explanation/)
[Convolution arithmetic](https://github.com/vdumoulin/conv_arithmetic)